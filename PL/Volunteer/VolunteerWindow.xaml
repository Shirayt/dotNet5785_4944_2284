<Window x:Class="PL.Volunteer.VolunteerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:local="clr-namespace:PL.Volunteer"
        xmlns:bo="clr-namespace:BO;assembly=BL"
        xmlns:pl="clr-namespace:PL"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Volunteer Details" Height="750" Width="620"
        DataContext="{Binding RelativeSource={RelativeSource Mode=Self}}"
        Loaded="VolunteerWindow_Loaded" Closed="VolunteerWindow_Closed">

    <Window.Resources>
        <!-- General formatting for field names -->
        <Style TargetType="Label">
            <Setter Property="HorizontalAlignment" Value="Right"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="5"/>
        </Style>
        <Style TargetType="Control">
            <Setter Property="Margin" Value="5"/>
        </Style>

        <pl:NullToCollapsedConverter x:Key="NullToCollapsedConverter"/>
        <pl:NullToVisibilityConverter x:Key="NullToVisibilityConverter"/>

        <DataTemplate DataType="{x:Type bo:CallInProgress}">
            <GroupBox Header="Call In Progress" Margin="5">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Label Content="Call ID" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding CallId}" Grid.Row="0" Grid.Column="1" VerticalAlignment="Center"/>

                    <Label Content="Type" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding CallType}" Grid.Row="1" Grid.Column="1" VerticalAlignment="Center"/>

                    <Grid Grid.Row="2" Grid.ColumnSpan="2"
                    Visibility="{Binding Description, Converter={StaticResource StringToVisibilityConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="150"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Label Content="Description" Grid.Column="0" VerticalAlignment="Center"/>
                        <TextBlock Text="{Binding Description}" Grid.Column="1" VerticalAlignment="Center" TextWrapping="Wrap"/>
                    </Grid>

                    <Label Content="Address" Grid.Row="3" Grid.Column="0" VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding FullAddress}" Grid.Row="3" Grid.Column="1" VerticalAlignment="Center" TextWrapping="Wrap"/>

                    <Label Content="Open Time" Grid.Row="4" Grid.Column="0" VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding OpenTime}" Grid.Row="4" Grid.Column="1" VerticalAlignment="Center"/>

                <Grid Grid.Row="5" Grid.ColumnSpan="2"
                         Visibility="{Binding MaxEndTime, Converter={StaticResource NullToVisibilityConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="150"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Label Content="Max End Time" Grid.Column="0" VerticalAlignment="Center"/>
                        <TextBlock Text="{Binding MaxEndTime}" Grid.Column="1" VerticalAlignment="Center"/>
                    </Grid>

                    <Label Content="Treatment Start" Grid.Row="6" Grid.Column="0" VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding TreatmentStartTime}" Grid.Row="6" Grid.Column="1" VerticalAlignment="Center"/>

                    <Label Content="Distance (km)" Grid.Row="7" Grid.Column="0" VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding DistanceFromVolunteer}" Grid.Row="7" Grid.Column="1" VerticalAlignment="Center"/>
                </Grid>
            </GroupBox>
        </DataTemplate>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <!-- Row for scrollable content -->
            <RowDefinition Height="*"/>
            <!-- Row for button -->
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <!-- 15 properties total -->
                    <RowDefinition Height="Auto" />
                    <!-- Id -->
                    <RowDefinition Height="Auto" />
                    <!-- FullName -->
                    <RowDefinition Height="Auto" />
                    <!-- PhoneNumber -->
                    <RowDefinition Height="Auto" />
                    <!-- Email -->
                    <RowDefinition Height="Auto" />
                    <!-- Password -->
                    <RowDefinition Height="Auto" />
                    <!-- Address -->
                    <RowDefinition Height="Auto" />
                    <!-- Latitude -->
                    <RowDefinition Height="Auto" />
                    <!-- Longitude -->
                    <RowDefinition Height="Auto" />
                    <!-- Role -->
                    <RowDefinition Height="Auto" />
                    <!-- IsActive -->
                    <RowDefinition Height="Auto" />
                    <!-- MaxDistance -->
                    <RowDefinition Height="Auto" />
                    <!-- DistanceType -->
                    <RowDefinition Height="Auto" />
                    <!-- Completed -->
                    <RowDefinition Height="Auto" />
                    <!-- Cancelled -->
                    <RowDefinition Height="Auto" />
                    <!-- Expired -->
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Id -->
                <!-- Editable Id field (not read-only) -->
                <Label Content="Id" Grid.Row="0" Grid.Column="0"/>
                <TextBox Text="{Binding CurrentVolunteer.Id}" Grid.Row="0" Grid.Column="1"/>

                <!-- FullName -->
                <!-- Editable field for full name -->
                <Label Content="Full Name" Grid.Row="1" Grid.Column="0"/>
                <TextBox Text="{Binding CurrentVolunteer.FullName, Mode=TwoWay}" Grid.Row="1" Grid.Column="1"/>

                <!-- PhoneNumber -->
                <!-- Editable field for phone number -->
                <Label Content="Phone Number" Grid.Row="2" Grid.Column="0"/>
                <TextBox Text="{Binding CurrentVolunteer.PhoneNumber, Mode=TwoWay}" Grid.Row="2" Grid.Column="1"/>

                <!-- Email -->
                <!-- Editable field for email -->
                <Label Content="Email" Grid.Row="3" Grid.Column="0"/>
                <TextBox Text="{Binding CurrentVolunteer.Email, Mode=TwoWay}" Grid.Row="3" Grid.Column="1"/>

                <!-- Password -->
                <!-- Editable field for password -->
                <Label Content="Password" Grid.Row="4" Grid.Column="0"/>
                <TextBox Text="{Binding CurrentVolunteer.Password, Mode=TwoWay}" Grid.Row="4" Grid.Column="1"/>

                <!-- Address -->
                <!-- Editable field for address -->
                <Label Content="Address" Grid.Row="5" Grid.Column="0"/>
                <TextBox Text="{Binding CurrentVolunteer.CurrentFullAddress, Mode=TwoWay}" Grid.Row="5" Grid.Column="1"/>

                <!-- Latitude -->
                <!-- Hidden in all modes -->
                <Label Content="Latitude" Grid.Row="6" Grid.Column="0"
                       Visibility="{Binding ButtonText, Converter={StaticResource ConvertUpdateToCollapsedKey}}"/>
                <TextBox Text="{Binding CurrentVolunteer.Latitude, Mode=TwoWay}" Grid.Row="6" Grid.Column="1" IsReadOnly="True"
                         Visibility="{Binding ButtonText, Converter={StaticResource ConvertUpdateToCollapsedKey}}"/>

                <!-- Longitude -->
                <!-- Hidden in all modes -->
                <Label Content="Longitude" Grid.Row="7" Grid.Column="0"
                       Visibility="{Binding ButtonText, Converter={StaticResource ConvertUpdateToCollapsedKey}}"/>
                <TextBox Text="{Binding CurrentVolunteer.Longitude, Mode=TwoWay}" Grid.Row="7" Grid.Column="1" IsReadOnly="True"
                         Visibility="{Binding ButtonText, Converter={StaticResource ConvertUpdateToCollapsedKey}}"/>

                <!-- Role -->
                <!-- Editable dropdown for volunteer role -->
                <Label Content="Role" Grid.Row="8" Grid.Column="0"/>
                <ComboBox ItemsSource="{Binding Source={StaticResource RoleCollectionKey}}"
                          SelectedItem="{Binding CurrentVolunteer.Role}" Grid.Row="8" Grid.Column="1"/>

                <!-- IsActive -->
                <!-- Editable checkbox for active status -->
                <Label Content="Is Active" Grid.Row="9" Grid.Column="0"/>
                <CheckBox IsChecked="{Binding CurrentVolunteer.IsActive, Mode=TwoWay}" Grid.Row="9" Grid.Column="1"/>

                <!-- MaxDistance -->
                <!-- Editable field for max distance -->
                <Label Content="Max Distance" Grid.Row="10" Grid.Column="0"/>
                <TextBox Text="{Binding CurrentVolunteer.MaxDistanceForCall, Mode=TwoWay}" Grid.Row="10" Grid.Column="1"/>

                <!--DistanceType 
                 Editable dropdown for distance type-->
                <Label Content="Distance Type" Grid.Row="11" Grid.Column="0"/>
                <ComboBox Grid.Row="11" Grid.Column="1"
                          ItemsSource="{Binding Source={StaticResource DistanceTypeCollectionKey}}"
                          SelectedValue="{Binding CurrentVolunteer.DistanceType, Mode=TwoWay}"/>

                <!-- AmountOfCompletedCalls -->
                <!-- Read-only field for number of completed calls -->
                <Label Content="Completed Calls" Grid.Row="12" Grid.Column="0"/>
                <TextBox Text="{Binding CurrentVolunteer.AmountOfCompletedCalls}" IsReadOnly="True"
                         Grid.Row="12" Grid.Column="1"/>

                <!-- AmountOfSelfCancelledCalls -->
                <!-- Read-only field for number of self-cancelled calls -->
                <Label Content="Self Cancelled" Grid.Row="13" Grid.Column="0"/>
                <TextBox Text="{Binding CurrentVolunteer.AmountOfSelfCancelledCalls}" IsReadOnly="True"
                         Grid.Row="13" Grid.Column="1"/>

                <!-- AmountOfExpiredCalls -->
                <!-- Read-only field for number of expired calls -->
                <Label Content="Expired Calls" Grid.Row="14" Grid.Column="0"/>
                <TextBox Text="{Binding CurrentVolunteer.AmountOfExpiredCalls}" IsReadOnly="True"
                         Grid.Row="14" Grid.Column="1"/>

                <ContentControl Grid.Row="15" Grid.ColumnSpan="2"
                Content="{Binding CurrentVolunteer.callInProgress}"
                Visibility="{Binding CurrentVolunteer.callInProgress, Converter={StaticResource NullToCollapsedConverter}}"/>

            </Grid>
        </ScrollViewer>

        <!-- Submit button with dynamic text (Add/Update) -->
        <Button Grid.Row="1" Content="{Binding ButtonText}" Click="btnAddUpdate_Click"
                HorizontalAlignment="Center" Width="100" Height="20"/>
    </Grid>
</Window>